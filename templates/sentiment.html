{% extends 'base.html' %}
{% load static %}


{% block body %}
<div id="primary" class="content-area">
    <main id="main" class="site-main">
        <div class="relative px-3 py-10">
            <div class="container px-3">
                <div class="flex items-start">
                    <div class="flex-grow-1 flex w-full flex-wrap rounded-lg border border-slate-200 bg-white dark:border-slate-800 dark:bg-slate-950 lg:flex-nowrap xl:max-h-[calc(100vh-theme(space.52))]">
                        <div class="w-full border-b border-slate-200 dark:border-slate-800 lg:w-2/5 lg:border-b-0 lg:border-e" style="height: 650px;">
                            <div class="h-full overflow-auto p-7 scrollbar-thin scrollbar-track-slate-200 scrollbar-thumb-slate-600 dark:scrollbar-track-slate-800">
                                <h3 class="mb-3 text-4xl font-bold text-slate-700 dark:text-white"> Sentiment Analysis </h3>
                                <p class="mb-5 text-slate-500 dark:text-slate-400"> Find your analysis of sentiment with AI </p>
                                <div class="mb-4 rounded-md border border-slate-200 bg-slate-50 p-3 dark:border-slate-800 dark:bg-slate-900">
                                    <p class="text-sm text-slate-500 dark:text-slate-400"> Your have <strong class="text-slate-600 dark:text-slate-200">3,47,179</strong> remaining tokens. </p>
                                </div>
                                <div class="-my-2">
                                    <div class="py-2">
                                        <label class="mb-2 inline-flex cursor-pointer text-sm font-bold text-slate-600 dark:text-slate-200"> Upload your text file </label>
                                        <div class="js-upload" id="UploadFiles">
                                            <div class="dz-message" data-dz-message>
                                                <div class="flex flex-col items-center">
                                                    <p class="mb-3 text-center text-sm font-medium text-slate-500 dark:text-slate-300"> Drag and Drop Your File (.csv, .txt, .excel) </p>
                                                    <div class="inline-flex cursor-pointer rounded bg-blue-600 px-2 py-1 text-sm font-medium text-white"> Browse </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="py-2">
                                        <label for="Language" class="mb-2 inline-flex cursor-pointer text-sm font-bold text-slate-600 dark:text-slate-200"> Language <span class="ms-2 text-[10px] text-slate-400">(Optional)</span>
                                        </label>
                                        <select id="Language" class="js-select z-10 w-full rounded-md border-slate-200 bg-white py-2 text-sm text-slate-600 dark:border-slate-800 dark:bg-slate-950 dark:text-slate-200">
                                            <option>English</option>
                                            <option>Bengali</option>
                                        </select>
                                    </div>
                                    <!-- <div class="py-2">
                                        <label for="Types" class="mb-2 inline-flex cursor-pointer text-sm font-bold text-slate-600 dark:text-slate-200"> Task Type <span class="ms-2 text-[10px] text-slate-400">(Optional)</span>
                                        </label>
                                        <select id="Types" class="js-select z-10 w-full rounded-md border-slate-200 bg-white py-2 text-sm text-slate-600 dark:border-slate-800 dark:bg-slate-950 dark:text-slate-200">
                                            <option>Transcribe Audio File</option>
                                            <option>Translate Audio File</option>
                                        </select>
                                    </div> -->
                                    <div class="py-2">
                                        <label for="prompt" class="mb-2 inline-flex cursor-pointer text-sm font-bold text-slate-600 dark:text-slate-200"> Or add your text here <span class="ms-2 text-[10px] text-slate-400">(Optional)</span>
                                        </label>
                                        <textarea class="input100"
                                        name="tynChatInput"
                                        id="tynChatInput" class="input100 mb-0 h-32 w-full rounded-md border-slate-200 bg-white py-2 text-sm text-slate-600 focus:border-slate-200 focus:shadow-none focus:outline-none dark:border-slate-800 dark:bg-slate-950 dark:text-slate-200" placeholder="Add your sentiment text to get analysis." id="prompt"></textarea>
                                    </div>
                                    <div class="py-2">
                                        <button type="button" id="chatbtn" class="inline-flex rounded-full bg-blue-600 px-5 py-2 text-sm font-medium text-white transition-all hover:bg-blue-800"> Generate </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- col -->
                        <div class="w-full lg:w-3/5">
                            <div class="flex h-full w-full items-center justify-center p-6 text-center">
                                <div class="flex flex-col items-center py-2">
                                    
                                    <div class="h-28">
                                        <svg class="h-full" version="1.1" id="ecommerce_1_" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 115 115" style="enable-background:new 0 0 115 115" xml:space="preserve"><style>.st0{fill:#ffeead}.st2{fill:#99734a}</style><g id="site_traffic_analitics_1_"><path d="M57.501 0v21.157a36.156 36.156 0 0 1 19.589 5.739L88.504 9.065A57.672 57.672 0 0 0 57.501 0z" style="fill:#71a58a"/><path class="st2" d="M104.03 23.702A57.35 57.35 0 0 0 88.503 9.065L77.09 26.896c7.977 5.117 13.82 13.26 15.907 22.814l20.678-4.538a57.292 57.292 0 0 0-9.645-21.47z"/><path class="st0" d="M83.198 83.198C76.622 89.775 67.536 93.843 57.5 93.843V115a57.237 57.237 0 0 0 33.798-10.971 58 58 0 0 0 6.869-5.862L83.198 83.198z"/><path class="st0" d="M57.5 93.842a36.164 36.164 0 0 1-19.589-5.738l-11.413 17.83A57.67 57.67 0 0 0 57.501 115L57.5 93.842z"/><path d="M23.703 10.971a58 58 0 0 0-6.869 5.862C2.762 30.871-2.793 51.003 1.327 69.827a57.29 57.29 0 0 0 9.645 21.471 57.334 57.334 0 0 0 15.527 14.637l11.413-17.83C27.839 81.643 21.158 70.355 21.158 57.5c0-20.071 16.271-36.343 36.342-36.343h.001V0a57.23 57.23 0 0 0-33.798 10.971z" style="fill:#96ceb4"/><path d="M87.475 78.046a36.605 36.605 0 0 1-4.276 5.152l14.969 14.969a57.087 57.087 0 0 0 6.767-8.154l-17.46-11.967z" style="fill:#ffcc5c"/><path d="m113.675 45.173-20.678 4.538c.548 2.51.846 5.115.846 7.789 0 7.626-2.354 14.7-6.368 20.546l17.459 11.967c8.985-13.11 12.118-29.412 8.741-44.84z" style="fill:#ff6f69"/><g><path class="st2" d="M38.642 47.703h-.298a3.05 3.05 0 0 0-3.041 3.041v25.808a3.05 3.05 0 0 0 3.041 3.041h.298a3.05 3.05 0 0 0 3.041-3.041V50.744a3.05 3.05 0 0 0-3.041-3.041z"/></g><g><path class="st2" d="M50.87 57.367h-.298a3.05 3.05 0 0 0-3.041 3.041v16.145a3.05 3.05 0 0 0 3.041 3.041h.298a3.05 3.05 0 0 0 3.041-3.041V60.408a3.05 3.05 0 0 0-3.041-3.041z"/></g><g><path class="st2" d="M63.097 28.376H62.8a3.05 3.05 0 0 0-3.041 3.041v45.136a3.05 3.05 0 0 0 3.041 3.041h.298a3.05 3.05 0 0 0 3.041-3.041V31.417a3.05 3.05 0 0 0-3.042-3.041z"/></g><g><path class="st2" d="M75.325 38.039h-.298a3.05 3.05 0 0 0-3.041 3.041v35.472a3.05 3.05 0 0 0 3.041 3.041h.298a3.05 3.05 0 0 0 3.041-3.041V41.08a3.05 3.05 0 0 0-3.041-3.041z"/></g></g></svg>
                                        <!-- <img class="h-full" src="https://www.flaticon.com/free-icon/analytics_9910053?term=analysis&page=1&position=11&origin=search&related_id=9910053" alt="" /> -->
                                    </div>
                                    <div class="mt-5 max-w-xs">
                                        <div id="report_dynamic_field">

                                        </div>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- col -->
                    </div>
                    <!-- row -->
                </div>
            </div>
            <!-- container -->
        </div>
    </main><!-- #main -->
</div><!-- .container -->
{% endblock body %}


{% block js%}
<script>
  $(document).ready(function () {
      // Send an AJAX request to the Django view
      $('#chatbtn').click(function () {
          var user_input = $("#tynChatInput").val(); // Corrected typo from 'ar' to 'var'
          $("#tynChatInput").val("");
          var firstValue = 0; // Ensure this is properly managed if needed for subsequent requests

          $.ajax({
              url: "{% url 'sentiment_add' %}",
              type: 'get',
              dataType: 'json',
              data: {
                  offset: user_input,
                  firstValue: firstValue
              },
              success: function(response) {
                  console.log(response);
                  firstValue = 4;

                  $('#report_dynamic_field').html(
                      '<div class="tyn-qa-item">' +
                          '<div class="tyn-qa-message tyn-text-block">' +
                             'Text : '+ response.data.my +
                          '</div>' +
                      '</div>' +
                      '<div class="tyn-qa-item mb-3">' +
                          '<div class="tyn-qa-message tyn-text-block">' +
                              '<p>' +
                                  response.data.chatbot_response + 
                              '</p>' +
                          '</div>' +
                      '</div>'
                  );
              },
              error: function() {
                  // Handle any errors
                  alert('Error loading more content.');
              }
          });
      });
  });
</script>


{% endblock js%}
